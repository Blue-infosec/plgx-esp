{% extends "layout.html" %}
{% block page_title %}
PolyLogyx - Hosts
{% endblock %}


{% block content %}
<script src="/static/js/utils.js"></script>
<!-- begin:: Content -->
<div class="kt-content  kt-grid__item kt-grid__item--fluid" id="kt_content">
	<div class="kt-portlet kt-portlet--mobile kt-portlet--responsive-mobile" style="margin-bottom: 0px;">
		<div class="kt-portlet__head">
			<div class="kt-portlet__head-label">
				<span class="kt-portlet__head-icon">
					<i class="kt-font-brand fa fa-desktop "></i>
				</span>
				<h3 class="kt-portlet__head-title">
					Hosts
				</h3>
			</div>
			<!--Begin::Section-1-->
			<div class="row">
				<!-- <div class="col-xl-3 col-md-2 col-lg-2 col-3 col-sm-3"></div> -->

				<div class="">
					<!--begin:: Windows Widgets -->
					<div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid #45b4f2; margin-right:15px; margin-bottom:0px;">
						<div class="kt-portlet__body" style="padding: 0px;" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="Windows Platforms">
							<div class="kt-widget14" style="padding:10px;">
								<!-- <div class="kt-widget14__header">
									<h3 class="kt-widget14__title" style="text-align: center;">
										Windows
									</h3>
								</div> -->
								<div class="kt-widget14__content">
									<!-- <i class="fab fa-5x fa-windows"></i> -->
									<img alt="Logo" src="/static/assets/media/logo/windows.svg" height="30px" width="30px" />
									<!-- Begin:: Windows -->
									<div class="kt-widget14__legends" style="line-height: 2.5rem; margin-top: auto;">
										<!-- Begin:: Windows Online -->
										<a {% if node_status.windows_online > 0 %} href="{{ url_for('manage.nodes' ,  platform=['windows'], state=['online']) }}" {% endif %}>
											<div class="kt-widget14__legend" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="online">
												<span class="kt-widget14__bullet kt-bg-success"></span>
												<span class="kt-widget14__stats">
													{% if node_status.windows_online > 0 %}
													<span style="color: #1b9300">
														{{ node_status.windows_online }}
													</span>
													{% else %}
													<span>0</span>
													{% endif %}
												</span>
											</div>
										</a>
										<!-- End:: Windows Online -->
										<!-- Begin:: Windows Offline -->
										<a {% if node_status.windows_offline > 0 %} href="{{ url_for('manage.nodes' ,  platform=['windows'], state=['offline']) }}" {% endif %}>
											<div class="kt-widget14__legend" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="offline">
												<span class="kt-widget14__bullet kt-bg-danger"></span>
												<span class="kt-widget14__stats">
													{% if node_status.windows_offline > 0 %}
													<span style="color: #f86c6b">
														{{ node_status.windows_offline }}
													</span>
													{% else %}
													<span>0</span>
													{% endif %}
												</span>
											</div>
										</a>
										<!-- End:: Windows Offline -->
									</div>
									<!-- Begin:: Windows -->
								</div>
							</div>
						</div>
					</div>
					<!--end:: Windows Widgets -->
				</div>
				<div class="">
					<!--begin:: Linux Widgets -->
					<div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid #363638; margin-right:15px; margin-bottom:0px;">
						<div class="kt-portlet__body" style="padding: 0px;" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="Linux Platforms">
							<div class="kt-widget14" style="padding:10px;">
								<!-- <div class="kt-widget14__header">
									<h3 class="kt-widget14__title" style="text-align: center;">
										Linux
									</h3>
								</div> -->
								<div class="kt-widget14__content">
									<!-- <i class="fab fa-5x fa-linux"></i> -->
									<img alt="Logo" src="/static/assets/media/logo/Linux1.svg" height="40px" width="30px" />
									<!-- begin:: Linux -->
									<div class="kt-widget14__legends" style="line-height: 2.5rem; margin-top: auto;">
										<!-- Begin:: Linux Online -->
										<a {% if node_status.linux_online > 0 %} href="{{ url_for('manage.nodes' ,  platform=['linux'], state=['online']) }}" {% endif %}>
											<div class="kt-widget14__legend" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="online">
												<span class="kt-widget14__bullet kt-bg-success"></span>
												<span class="kt-widget14__stats">
													{% if node_status.linux_online > 0 %}
													<span style="color: #1b9300">
														{{ node_status.linux_online }}
													</span>
													{% else %}
													<span>0</span>
													{% endif %}
												</span>
											</div>
										</a>
										<!-- End:: Linux Online -->

										<!-- begin:: Linux Offline -->
										<a {% if node_status.linux_offline > 0 %} href="{{ url_for('manage.nodes' , platform=['linux'], state=['offline']) }}" {% endif %}>
											<div class="kt-widget14__legend" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="offline">
												<span class="kt-widget14__bullet kt-bg-danger"></span>
												<span class="kt-widget14__stats">
													{% if node_status.linux_offline > 0 %}
													<span style="color: #f86c6b">
														{{ node_status.linux_offline }}
													</span>
													{% else %}
													<span>0</span>
													{% endif %}
												</span>
											</div>
										</a>
										<!-- End:: Linux Offline -->
									</div>
									<!-- End:: Linux -->

								</div>
							</div>
						</div>
					</div>
					<!--end:: Linux Widgets-->
				</div>
				<div class="">
					<!--begin:: Apple Widgets -->
					<div class="kt-portlet kt-portlet--border-bottom-brand" style="border-bottom: 3px solid #8e8e93; margin-right:15px; margin-bottom:0px;">
						<div class="kt-portlet__body" style="padding: 0px;" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="Mac Platforms">
							<div class="kt-widget14" style="padding:10px;">
								<!-- <div class="kt-widget14__header">
									<h3 class="kt-widget14__title" style="text-align: center;">
										Apple
									</h3>
								</div> -->
								<div class="kt-widget14__content kt-widget21__icon">
									<i class="fab fa-4x fa-apple" style="color: #8e8e93;"></i>
									<!-- <img alt="Logo" src="/static/assets/media/logo/apple.svg" height="50px" width="50px" /> -->
									<!-- Begin:: Mac -->
									<div class="kt-widget14__legends" style="line-height: 2.5rem; margin-top: auto;">
										<!-- begin:: Mac Online -->
										<a {% if node_status.darwin_online > 0 %} href="{{ url_for('manage.nodes' ,  platform=['darwin'], state=['online']) }}" {% endif %}>
											<div class="kt-widget14__legend" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="online">
												<span class="kt-widget14__bullet kt-bg-success"></span>
												<span class="kt-widget14__stats">
													{% if node_status.darwin_online > 0 %}
													<span style="color: #1b9300">
														{{ node_status.darwin_online }}
													</span>
													{% else %}
													<span>0</span>
													{% endif %}
												</span>
											</div>
										</a>
										<!-- End:: Mac Online -->

										<!-- begin:: Mac Offline -->
										<a {% if node_status.darwin_offline > 0 %} href="{{ url_for('manage.nodes' , platform=['darwin'], state=['offline']) }}" {% endif %}>
											<div class="kt-widget14__legend" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="offline">
												<span class="kt-widget14__bullet kt-bg-danger"></span>
												<span class="kt-widget14__stats">
													{% if node_status.darwin_offline > 0 %}
													<span style="color: #f86c6b">
														{{ node_status.darwin_offline }}
													</span>
													{% else %}
													<span>0</span>
													{% endif %}
												</span>
											</div>
										</a>
										<!-- End:: Mac Offline -->
									</div>
									<!-- End:: Mac -->
								</div>
							</div>
						</div>
					</div>
					<!--end:: Apple Widgets -->
				</div>
				<!-- <div class="col-xl-3 col-md-2 col-lg-2 col-3 col-sm-3"></div> -->
			</div>
			<!--End::Section-1-->
			<div class="kt-portlet__head-toolbar">
				<div class="kt-portlet__head-wrapper">
					<div class="kt-portlet__head-actions">
						<button type="button" onclick="exportNodeCSV(this);" class="btn btn-outline-success btn-sm btn-icon-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-skin="dark" data-toggle="kt-tooltip" data-placement="top"
							title="Download CSV File">
							<i class="la la-download"></i> Export
						</button>
					</div>
				</div>
			</div>
		</div>
		<div id="container" style="display:none;"></div>
		<div class="kt-portlet__body">

			<!-- begin:: Table -->

			{% include "tables/nodes.html" %}


			<!-- end:: Table -->

		</div>
	</div>
	<!-- end:: Content -->

</div>

<script type="text/javascript">
	function exportNodeCSV(e) {
		var request_params = {};
		request_params['csrf_token'] = '{{csrf_token()}}';

		var currentDate = new Date();

		$.ajax({
			"url": "/manage/nodes/export",
			"type": 'POST',
			"data": request_params,
			"success": function(res, status, xhr) {
				var csvData = new Blob([res], {
					type: 'text/csv;charset=utf-8;'
				});
				var csvURL = window.URL.createObjectURL(csvData);
				var tempLink = document.createElement('a');
				tempLink.href = csvURL;
				tempLink.setAttribute('download', 'nodes' + '_' + currentDate.getTime());
				document.getElementById('container').appendChild(tempLink);
				tempLink.click();
			}
		});
		return false;
	}
	
</script>



{% endblock %}
